{"knowledge": "中断、异常与系统调用。\r\n", "question": "\"1）试说明硬中断（hardware interrupt）、异常（exception）和系统调用（system call）的相同点和不同点。\r\n2）下面代码完成在进入trap()函数前的准备工作。其中pushal完成包括esp在内的CPU寄存器压栈。试说明“pushl %esp”的作用是什么？\r\n=============trapentry.S (kern\\trap)============= #include  # vectors.S sends\r\nall traps here. .text .globl __alltraps __alltraps: # push registers to build\r\na trap frame # therefore make the stack look like a struct trapframe pushl %ds\r\npushl %es pushl %fs pushl %gs pushal # load GD_KDATA into %ds and %es to set\r\nup data segments for kernel movl $GD_KDATA, %eax movw %ax, %ds movw %ax, %es\r\npushl %esp call trap # pop the pushed stack pointer popl %esp # return falls\r\nthrough to trapret... .globl __trapret __trapret: # restore registers from\r\nstack popal # restore %ds, %es, %fs and %gs popl %gs popl %fs popl %es popl\r\n%ds # get rid of the trap number and error code addl $0x8, %esp iret\r\n=============Trap.c (kern\\trap)============= ...... /   trap - handles or\r\ndispatches an exception/interrupt. if and when trap() returns,  the code in\r\nkern/trap/trapentry.S restores the old CPU state saved in the  trapframe and\r\nthen uses the iret instruction to return from the exception.  / void\r\ntrap(struct trapframe tf) { // dispatch based on what type of trap occurred\r\ntrap_dispatch(tf); } ......\"\r\n\r\n", "degree_of_difficulty": "1\r\n", "source": "网络\r\n", "answer": " Hardware interrupt  Interruption based on an external hardware event external to the CPU  An interrupt is generally initiated by an I/O device, and causes the CPU to stop what it's doing  Exception  an exceptional condition in the processor (Illed program)  an interrupt that is caused by software (by executing an instruction)  System call  a programmer initiated in user mode and expected transfer of control to the kernel  an interrupt that is caused by software (by executing an instruction) 共同：中断当前执行/保存现场（3分） 不同：产生原因(每个2分) 2)3分 给trap函数传参数，汇编调用C时如何传参。 # push %esp to pass a pointer to the trapframe as an argument to trap() pushl %esp # call trap(tf), where tf=%esp call trap", "type": "4\r\n", "options": "  \r\n"}